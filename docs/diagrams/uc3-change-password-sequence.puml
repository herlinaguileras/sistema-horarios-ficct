@startuml
skinparam sequenceArrowThickness 2
skinparam roundcorner 20
skinparam maxmessagesize 60
skinparam sequenceParticipant underline

actor Usuario
participant "update-password-form.blade.php" as PasswordView <<Boundary>>
participant "PasswordController" as Controller <<Control>>
participant "User" as UserModel <<Entity>>

Usuario -> PasswordView: ingresarContrasenas()
activate PasswordView

PasswordView -> PasswordView: mostrarFormulario()

Usuario -> PasswordView: submitForm(current_password, password, password_confirmation)

PasswordView -> Controller: PUT route('password.update')
activate Controller

Controller -> Controller: update(Request)

Controller -> Controller: validateWithBag('updatePassword')

Controller -> Controller: validarCampos()

Controller -> UserModel: verificarContrasenaActual(current_password)
activate UserModel

UserModel -> UserModel: checkCurrentPassword()

UserModel --> Controller: contrasenaValida
deactivate UserModel

Controller -> Controller: Hash::make(password)

Controller -> UserModel: actualizarContrasena(hashedPassword)
activate UserModel

UserModel -> UserModel: update(['password' => hashedPassword])

UserModel --> Controller: contrasenaActualizada
deactivate UserModel

Controller -> Controller: back()->with('status', 'password-updated')

Controller --> PasswordView: RedirectResponse(status)
deactivate Controller

PasswordView --> Usuario: mostrarMensajeExito()
deactivate PasswordView

@enduml
